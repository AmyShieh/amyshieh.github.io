"use strict";(self.webpackChunkmy_docusaurus_blog=self.webpackChunkmy_docusaurus_blog||[]).push([[4934],{42283:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>T,contentTitle:()=>S,default:()=>G,frontMatter:()=>M,metadata:()=>n,toc:()=>P});const n=JSON.parse('{"id":"graphic/threejs/demo","title":"demo","description":"{() => (","source":"@site/docs/graphic/threejs/demo.mdx","sourceDirName":"graphic/threejs","slug":"/graphic/threejs/demo","permalink":"/docs/graphic/threejs/demo","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Threejs","permalink":"/docs/graphic/threejs/"},"next":{"title":"(WIP)3d - webgl","permalink":"/docs/graphic/webgl"}}');var r=s(74848),a=s(28453),o=s(39437),i=s(43907),c=s(17024),d=s(65540),l=s(65804),u=s(94742),p=s(92763),f=s(96540),h=s(56318),w=s(53945);const m=800,x=500,b=new o.tcD(50),g=new o.iNn(100,100,100),j=new o.Gu$(50),v=new o.bdM(100,100),y=new o.fTw(300,10,16711918,14544639),E=new p.B;new o.tBo;function A(e){const{type:t}=e,s=(0,f.useRef)(null),n=new o.Z58,[a,p]=(0,f.useState)(j),[A,k]=(0,f.useState)((new o.Tap).load("https://gd-hbimg.huaban.com/55a9bf701ec3c9bf7a780e01bf79ef5721cc29f9c9bff-kcQlZy_fw1200webp")),[B,C]=(0,f.useState)(!1),M=(0,f.useMemo)(()=>new o.tXL({map:A,transparent:B}),[A,B]),S=(0,f.useMemo)(()=>new o.eaF(a,M),[a,M,t]),[T,P]=(0,f.useState)(new o.IzY(200)),F=new o.$p8(16777215,.8),G=new o.ZyN(16777215,.8);G.position.set(400,200,300);const[N,Y]=(0,f.useState)(new o.ubm(30,m/x,.1,1e4)),I=(0,f.useMemo)(()=>new o.YJl,[t]),_=(0,f.useMemo)(()=>new o.JeP({antialias:!0,preserveDrawingBuffer:!0}),[t]),z=(0,f.useMemo)(()=>new c.N(N,_.domElement),[_,t]),[J,W]=(0,f.useState)(!1),[O,q]=(0,f.useState)(0),Z=new d.s(_),D=new l.A(n,N),[L,R]=(0,f.useState)(new o.I9Y);Z.addPass(D);const V=new o.I9Y(m,x),X=new u.G(V,n,N);X.visibleEdgeColor.set(255);const $=(0,f.useCallback)(()=>{const e=_.domElement,t=document.createElement("a");t.href=e.toDataURL("image/png"),t.download="threejs.png",t.click()},[]);return(0,f.useEffect)(()=>{_?.domElement?.addEventListener("click",e=>{const{offsetX:t,offsetY:s}=e,n=t/m*2-1,r=-s/x*2+1;console.log({px:t,py:s,x:n,y:r}),R(new o.I9Y(n,r))})},[_,N,n.children]),(0,f.useEffect)(()=>{_.setSize(m,x),_.setClearColor(16711918,.05)},[_]),(0,f.useEffect)(()=>{switch(N.position.set(200,200,200),N.lookAt(0,0,0),t){case"basic":P(new o.IzY(1e3));for(let e=0;e<3;e++){const t=new o.V9B({color:268435200}),s=new o.eaF(g,t);s.position.x=200*e,I.add(s)}return N.position.set(875,370,700),N.lookAt(184,50,90),z.target.set(184,50,90),void z.update();case"uv":return void p(b);case"arrayPattern":{p(v);const e=(new o.Tap).load("https://gd-hbimg.huaban.com/0937ce9c977cd9b6714d948e9e933a6b7e1bd3562a1a6-zSpiyj_fw658webp");return e.wrapS=o.GJx,e.wrapT=o.GJx,e.repeat.set(10,10),k(e),void N.position.set(100,100,100)}case"transparentTextureWithGrid":{const e=(new o.Tap).load("https://gd-hbimg.huaban.com/3af0ba78ca7c7aab9642efaa47d45b70dfebe91d222d-ycdmz3_fw1200webp");return C(!0),k(e),p(v),N.position.set(30,707,569),N.lookAt(-10,25,30),z.target.set(-10,25,30),void z.update()}case"textureOffset":{const e=(new o.Tap).load("https://gd-hbimg.huaban.com/c472d5cd84f9b26202e80b1609a9b0bd24acda301eb6-ZkWnbg_fw658webp");return C(!0),e.wrapS=o.GJx,k(e),void p(v)}case"gltf":return P(new o.IzY(2)),E.load("/resource/fist.gltf",e=>{e.scene.traverse(e=>{e.isMesh&&(e.metalness=1,e.roughness=0)}),I.add(e.scene)},e=>{const{lengthComputable:t,loaded:s,total:n}=e;W(t),q(t?s/n:s)}),N.position.set(4,1,4),void N.lookAt(-1,0,-1);case"traverse":{const e=new o.YJl;e.name="\u9ad8\u5c42\u697c";for(let s=0;s<5;s++){const t=new o.iNn(40,200,40),n=new o.V9B({color:268435200}),r=new o.eaF(t,n);r.position.x=60*s,r.name=`${s+1}\u53f7\u697c`,e.add(r)}e.position.y=100;const t=new o.YJl;t.name="\u6d0b\u623f";for(let s=0;s<5;s++){const e=new o.iNn(40,60,40),n=new o.V9B({color:65535}),r=new o.eaF(e,n);r.position.x=60*s,r.name=`${s+1}\u53f7\u697c`,t.add(r)}return t.position.z+=100,t.position.y=30,I.add(e,t),I.traverse(e=>{"2\u53f7\u697c"===e.name&&e.material.color.set(16231612)}),N.position.set(30,707,568),N.lookAt(91,28,35),z.target.set(91,28,35),void z.update()}default:return}},[t]),(0,f.useEffect)(()=>{n.add(T,F,G);const e=S.clone();switch(t){case"basic":case"gltf":return void n.add(I);case"arrayPattern":case"textureOffset":e.rotateX(-Math.PI/2);break;case"transparentTextureWithGrid":e.rotateX(-Math.PI/2),e.position.y=3,y.position.y=-3,n.add(y);break;case"traverse":return X.selectedObjects=[I],Z.addPass(X),void n.add(I)}n.add(e)},[S,T,F,I]),(0,f.useEffect)(()=>{if(s.current){const e=s.current?.getElementsByTagName("canvas").length;e||s.current.appendChild(_.domElement)}},[s.current]),(0,f.useEffect)(()=>{const e=()=>{switch(t){case"basic":case"transparentTextureWithGrid":default:break;case"traverse":return Z.render(),void window.requestAnimationFrame(e);case"textureOffset":A.offset.x+=.001}_.render(n,N),window.requestAnimationFrame(e)};e()},[t,n,N]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{id:t,ref:s},t),["traverse"].includes(t)&&(0,r.jsx)("div",{className:"flex",children:"\u904d\u5386 & \u901a\u9053\u56fe"}),["transparentTextureWithGrid"].includes(t)&&(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{children:"\u900f\u660e\u8d34\u56fe\u5f00\u542f"}),(0,r.jsx)(h.A,{checked:B,onChange:e=>C(e)})]}),["textureOffset"].includes(t)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:(0,r.jsx)(w.Ay,{onClick:$,children:"\u4fdd\u5b58\u5f53\u524dcanvas\u4e3a\u56fe\u7247\u529f\u80fd~ \u70b9\u6211\u8bd5\u8bd5"})}),"\u5173\u4e8e\u8d34\u56fe\u4e0egeometry\u7684\u8d34\u56fe\u53d8\u5f62\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u53c2\u8003",(0,r.jsx)("a",{target:"_blank",href:"https://github.com/puxiao/threejs-tutorial/blob/main/25%20Three.js%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B9%8B%E6%B7%BB%E5%8A%A0%E8%83%8C%E6%99%AF%E5%92%8C%E5%A4%A9%E7%A9%BA%E7%9B%92.md",children:"\u8fd9\u4e2a\u6559\u7a0b\u91cc\u7684\u63cf\u8ff0"})]}),["gltf"].includes(t)&&(0,r.jsxs)("div",{children:[(0,r.jsx)(i.A,{style:{width:"78%"},percent:J?100*O:100,status:"active",format:e=>""+(J?e+"%":"\u5df2\u52a0\u8f7d"+Math.round(O/1024/1024*100)/100+"M")}),(0,r.jsxs)("div",{children:["\u9700\u8981gltf\u9759\u6001\u8d44\u6e90\u505a\u6d4b\u8bd5\u7684\u540c\u5b66\u53ef\u4ee5\u76f4\u63a5",(0,r.jsx)("a",{target:"_blank",href:"/resource/fist.gltf",children:"\u70b9\u8fd9\u91cc\u4e0b\u8f7d"}),"\u8d44\u6e90\u6e90\u4e8e\u7f51\u7edc\uff0c\u4fb5\u5220"]})]})]})}var k=s(42302);const B=e=>{const{type:t}=e,s=(0,f.useRef)(null),n=new o.JeP;n.setSize(800,500),n.setClearColor(16711918,.05);const a=new o.ubm(45,window.innerWidth/window.innerHeight,1,500);a.position.set(0,0,100),a.lookAt(0,0,0);const i=new o.Z58,d=new o.IzY(200);(0,f.useMemo)(()=>new c.N(a,n.domElement),[n,t]);return(0,f.useEffect)(()=>{s.current&&(console.log((0,k.A)()),s.current.appendChild(n.domElement))},[s]),(0,f.useEffect)(()=>{const e=()=>{if("line"===t)i.add((()=>{const e=[new o.Pq0(-10,0,0),new o.Pq0(0,10,0),new o.Pq0(10,0,0)],t=(new o.LoY).setFromPoints(e),s=new o.mrM({color:255});return new o.N1A(t,s)})());i.add(d),n.render(i,a),window.requestAnimationFrame(e)};e()},[t]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{id:t,ref:s}),(0,r.jsx)("p",{children:"line\u7ed8\u5236"})]})};var C=s(78478);const M={},S=void 0,T={},P=[];function F(e){return(0,r.jsx)(C.A,{children:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B,{type:"line"}),(0,r.jsx)(A,{type:"basic"}),(0,r.jsx)("p",{children:"\u57fa\u7840geometry"}),(0,r.jsx)(A,{type:"line"}),(0,r.jsx)("p",{children:"draw line"}),(0,r.jsx)(A,{type:"texture"}),(0,r.jsx)("p",{children:"\u7403\u5f62\u8d34\u56fe"}),(0,r.jsx)(A,{type:"uv"}),(0,r.jsx)("p",{children:"\u5706\u5f62\u8d34\u56fe-uv\u5750\u6807\uff0c\u53ef\u4ee5\u9009\u62e9\u90e8\u5206\u5c55\u793a\uff0c4\u4e2a\u5750\u6807\uff0c\u8bbe\u5b9a\u9876\u70b9\u3002\uff08\u77e9\u5f62\uff09"}),(0,r.jsx)(A,{type:"arrayPattern"}),(0,r.jsx)("p",{children:"planeGeometry\u8d34\u56fe\u9635\u5217"}),(0,r.jsx)(A,{type:"transparentTextureWithGrid"}),(0,r.jsx)("p",{children:"\u900f\u660e\u8d34\u56feWith GridHelper"}),(0,r.jsx)(A,{type:"textureOffset"}),(0,r.jsx)("p",{children:"\u8d34\u56fe\u7684\u504f\u79fb-\u4fee\u6539UV\u9876\u70b9\u5750\u6807"}),(0,r.jsx)(A,{type:"gltf"}),(0,r.jsx)("p",{children:"gltf\u6a21\u578b\u52a0\u8f7d"}),(0,r.jsx)(A,{type:"traverse"}),(0,r.jsx)("p",{children:"traverse"})]})})}function G(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(F,{...e})}):F()}}}]);